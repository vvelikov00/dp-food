<div class="flex items-center mt-3">
  <img src="assets/logo.png" alt="logo" class="w-16" />
  <h3 class="text-4xl font-bold text-slate-200 ml-3">
    <?php echo $title; ?>
  </h3>
</div>
<div class="flex justify-center">
  <div class="w-4/6 h-full flex flex-col">
    <form method="get" id="form">
      <input id="view-input" type="hidden" name="view" value="table" />
      <input id="sort-input" type="hidden" name="sort" value="name-asc" />
    </form>
    <div class="flex justify-end items-center">
      <div
        class="bg-white cursor-pointer text-gray-900 rounded-md gap-x-1.5 px-2.5 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 mr-2"
        id="view-button"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          height="20"
          width="20"
          viewBox="0 0 512 512"
          class="hidden"
          id="view-table"
        >
          <!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.-->
          <path
            d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"
          />
        </svg>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          height="20"
          width="20"
          viewBox="0 0 448 512"
          class="block"
          id="view-cards"
        >
          <!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.-->
          <path
            d="M128 136c0-22.1-17.9-40-40-40L40 96C17.9 96 0 113.9 0 136l0 48c0 22.1 17.9 40 40 40H88c22.1 0 40-17.9 40-40l0-48zm0 192c0-22.1-17.9-40-40-40H40c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40H88c22.1 0 40-17.9 40-40V328zm32-192v48c0 22.1 17.9 40 40 40h48c22.1 0 40-17.9 40-40V136c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM288 328c0-22.1-17.9-40-40-40H200c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40h48c22.1 0 40-17.9 40-40V328zm32-192v48c0 22.1 17.9 40 40 40h48c22.1 0 40-17.9 40-40V136c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM448 328c0-22.1-17.9-40-40-40H360c-22.1 0-40 17.9-40 40v48c0 22.1 17.9 40 40 40h48c22.1 0 40-17.9 40-40V328z"
          />
        </svg>
      </div>
      <div class="relative inline-block text-left w-56 self-end" id="sort-area">
        <div>
          <button
            id="sort-button"
            type="button"
            class="inline-flex w-full justify-between gap-x-1.5 rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"
            id="menu-button"
            aria-expanded="true"
            aria-haspopup="true"
          >
            <p id="sort-by">Сортиране по</p>
            <svg
              id="sort-icon"
              class="-mr-1 h-5 w-5 text-gray-400"
              viewBox="0 0 20 20"
              fill="currentColor"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
                clip-rule="evenodd"
              />
            </svg>
          </button>
        </div>
        <div
          id="sort-menu"
          class="absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none hidden"
          role="menu"
          aria-orientation="vertical"
          aria-labelledby="menu-button"
          tabindex="-1"
        >
          <div class="py-1" role="none">
            <!-- Active: "bg-gray-100 text-gray-900", Not Active: "text-gray-700" -->
            <div
              class="text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 hover:text-gray-900 cursor-pointer"
              role="menuitem"
              tabindex="-1"
              id="name-asc"
            >
              Име - Възходящ
            </div>
            <div
              class="text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 hover:text-gray-900 cursor-pointer"
              role="menuitem"
              tabindex="-1"
              id="name-desc"
            >
              Име - Низходящ
            </div>
            <div
              class="text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 hover:text-gray-900 cursor-pointer"
              role="menuitem"
              tabindex="-1"
              id="category-asc"
            >
              Категория - Възходящ
            </div>
            <div
              class="text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 hover:text-gray-900 cursor-pointer"
              role="menuitem"
              tabindex="-1"
              id="category-desc"
            >
              Категория - Низходящ
            </div>
          </div>
        </div>
      </div>
    </div>
    <?php echo $content ?>
  </div>
</div>
<script>
  const button = document.getElementById("sort-button");
  const sortBy = document.getElementById("sort-by");
  const menu = document.getElementById("sort-menu");
  const icon = document.getElementById("sort-icon");
  const items = document.querySelectorAll("[role='menuitem']");
  const sortArea = document.getElementById("sort-area");
  const viewButton = document.getElementById("view-button");
  const firstItem = items[0];
  const lastItem = items[items.length - 1];
  const view = "<?php echo $view; ?>";
  const sort = "<?php echo $sort; ?>";
  if (view !== "table") {
    document.getElementById("view-table").classList.remove("hidden");
    document.getElementById("view-cards").classList.add("hidden");
  } else {
    document.getElementById("view-table").classList.add("hidden");
    document.getElementById("view-cards").classList.remove("hidden");
  }
  document.getElementById("view-input").value = view;

  if (sort === "name-asc") {
    sortBy.innerHTML = "Име - Възходящ";
  } else if (sort === "name-desc") {
    sortBy.innerHTML = "Име - Низходящ";
  } else if (sort === "category-asc") {
    sortBy.innerHTML = "Категория - Възходящ";
  } else if (sort === "category-desc") {
    sortBy.innerHTML = "Категория - Низходящ";
  }
  document.getElementById("sort-input").value = sort;

  viewButton.addEventListener("click", () => {
    const input = document.getElementById("view-input");
    if (input.value === "table") {
      input.value = "cards";
    } else {
      input.value = "table";
    }
    document.getElementById("form").submit();
  });

  document.addEventListener("click", (e) => {
    if (!sortArea.contains(e.target)) {
      menu.classList.add("hidden");
    }
  });

  button.addEventListener("click", () => {
    menu.classList.toggle("hidden");
    menu.classList.toggle("block");
  });

  button.addEventListener("keydown", (e) => {
    if (e.code === "Space" || e.code === "Enter") {
      e.preventDefault();
      menu.classList.toggle("hidden");
      menu.classList.toggle("block");
      firstItem.focus();
    }
  });

  lastItem.addEventListener("keydown", (e) => {
    if (e.code === "Tab" && !e.shiftKey) {
      e.preventDefault();
      menu.classList.toggle("hidden");
      menu.classList.toggle("block");
      button.focus();
    }
  });

  items.forEach((item, index) => {
    item.addEventListener("click", () => {
      const input = document.getElementById("sort-input");
      input.value = item.id;
      document.getElementById("form").submit();
    });
  });
</script>
